{% load staticfiles %}
{% load custom_filters %}
<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" type="text/css" href="{% static 'onepoll/css/index.css' %}"/>
    <link rel="stylesheet" type="text/css" href="{% static 'onepoll/css/category.css' %}"/>
    <link rel="stylesheet" type="text/css" href="{% static 'onepoll/css/navigation.css' %}"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script type="text/javascript" src="{% static 'onepoll/js/accounts.js' %}"></script>
    <title>Home</title>
</head>

<body>
    <div id="navigation">
        <h1>onepoll</h1>
        <ul>
            <li><a href="{% url 'index' %}" class='active'>Home</a></li>
            <li><a href="{% url 'new' %}">New poll</a></li>
            <li><a href="{% url 'random' %}">Random poll</a></li>
            <li><a href="{% url 'public' %}">Public polls</a></li>
            <li style="float: right; background-color: #CD5555">
                <a onclick="accountSlide()" href="javascript:void(0);">Sign In / Register</a>
            </li>
        </ul>

        <form method="POST" action="/login/">
            {% csrf_token %}
            <div class='accounts-label'>
                username:
            </div>
            <input type="text" name='username'/>
            <div class='accounts-label'>
                password:
            </div>
            <input type="password" name='password'/>
            <input type="submit" value="login"/>
            <div class='accounts-register'>
                 Don't have an account? <a href="{% url 'register' %}">Register here</a>.
            </div>
        </form>
    </div>

    <div class='centre-block' id="latest-poll">
        <div class='centre-block-title'>
            Latest poll
        </div>
        {% if poll %}
        <div class='category-entry' name='{{ poll.category }}'>
            <div class="category-name">
                {{ poll.category }}
            </div>
        </div>
        <a href="{% url 'detail' poll.id %}">{{ poll.question_text }}</a>
        {% else %}
        <p>No polls are available.</p>
        {% endif %}
    </div>

    <div class='centre-block'>
        <div class='centre-block-title'>
            Stats
        </div>
        <div id="statistics">
            <div class='statistic'>
                <div class='statistic-title'>
                    {% if total_polls %}
                    {{ total_polls }} Poll{{ total_polls|pluralize }}
                    {% else %}
                    0 Polls
                    {% endif %}
                </div>
                <div class='statistic-detail'>
                    {% if public_polls %}
                    Public polls: {{ public_polls }}
                    {% else %}
                    Public polls: 0
                    {% endif %}
                </div>
                <div class='statistic-detail'>
                    {% if total_polls %}
                    Private polls: {{ total_polls|subtract:public_polls }}
                    {% else %}
                    Private polls: 0
                    {% endif %}
                </div>
            </div>
            <div class='statistic'>
                <div class='statistic-title'>
                    {% if unique_voters %}
                    {{ unique_voters}} voter{{ unique_voters|pluralize }}
                    {% else %}
                    0 voters
                    {% endif%}
                </div>
                <div class='statistic-detail'>
                    {% if total_polls %}
                    Average votes per poll: {{ votes_casted|divide:total_polls }}
                    {% else %}
                    Average votes per poll: 0
                    {% endif %}
                </div>
                <div class='statistic-detail'>
                    {% if votes_casted %}
                    Votes casted: {{ votes_casted }}
                    {% else %}
                    Votes casted: 0
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</body>
</html>
